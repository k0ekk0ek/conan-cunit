--- source_subfolder/CUnit/Sources/Console/Console.c	2020-07-30 01:25:28.517888177 +0200
+++ source_subfolder/CUnit/Sources/Console/Console.c.patched	2020-07-30 01:24:29.788091404 +0200
@@ -164,7 +164,7 @@
                     _("(R)un  (S)elect  (L)ist  (A)ctivate  (F)ailures  (O)ptions  (H)elp  (Q)uit"),
                     _("Enter command: "));
     chChoice = toupper(getchar());
-    fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
+    (void)!fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
 
     if (chChoice == _("R")[0]) {
       console_run_all_tests(pRegistry);
@@ -243,7 +243,7 @@
                     _("(R)un (S)elect (L)ist (A)ctivate (F)ailures (U)p (O)ptions (H)elp (Q)uit"),
                     _("Enter command: "));
     chChoice = toupper(getchar());
-    fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
+    (void)!fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
 
     if (chChoice == _("R")[0]) {
       console_run_suite(pSuite);
@@ -322,7 +322,7 @@
     fprintf(stdout, "%s",
                     _("Enter number of option to change : "));
     chChoice = getchar();
-    fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
+    (void)!fgets(szTemp, 256, stdin);      /* flush any chars out of the read buffer */
 
     switch (tolower(chChoice)) {
       case '1':
@@ -420,7 +420,9 @@
     fprintf(stdout, "\n");
     fprintf(stdout, _("Enter number of test to select (1-%u) : "),
                     pSuite->uiNumberOfTests);
-    fgets(buffer, 100, stdin);
+    if (NULL == fgets(buffer, 100, stdin)) {
+      return CUE_NOTEST;
+    }
 
     *ppTest = CU_get_test_by_index(atol(buffer), pSuite);
   }
@@ -459,7 +461,9 @@
     fprintf(stdout, "\n");
     fprintf(stdout, _("Enter number of suite to select (1-%u) : "),
                     pRegistry->uiNumberOfSuites);
-    fgets(buffer, 100, stdin);
+    if (NULL == fgets(buffer, 100, stdin)) {
+      return CUE_NOSUITE;
+    }
 
     *ppSuite = CU_get_suite_by_index(atol(buffer), pRegistry);
   }
